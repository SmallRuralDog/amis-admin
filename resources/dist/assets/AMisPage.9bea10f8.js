var O=Object.defineProperty,z=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var w=(t,e,a)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,g=(t,e)=>{for(var a in e||(e={}))H.call(e,a)&&w(t,a,e[a]);if(h)for(var a of h(e))K.call(e,a)&&w(t,a,e[a]);return t},b=(t,e)=>z(t,G(e));import{r as _,i as M,j as Y,g as f,c as L,p as Z,_ as q}from"./AMisRenderer.a38db3c1.js";import{aa as D,r as S,H as T,ab as F,Y as m,x as $,y as V,z as Q,E,T as I,G as N,a3 as J,i as j,ac as U,d as W,a4 as X,l as ee,ad as te,a5 as ae,w as ne,f as le,u as y,m as k,n as oe,v as se,K as re}from"./main.b9eb9475.js";function ie(t){let e;const a=S(!1),n=T(b(g({},t),{originalPosition:"",originalOverflow:"",visible:!1}));function s(l){n.text=l}function o(){const l=n.parent;if(!l.vLoadingAddClassList){let r=l.getAttribute("loading-number");r=Number.parseInt(r)-1,r?l.setAttribute("loading-number",r.toString()):(_(l,"el-loading-parent--relative"),l.removeAttribute("loading-number")),_(l,"el-loading-parent--hidden")}i(),v.unmount()}function i(){var l,r;(r=(l=d.$el)==null?void 0:l.parentNode)==null||r.removeChild(d.$el)}function c(){var l;if(t.beforeClose&&!t.beforeClose())return;const r=n.parent;r.vLoadingAddClassList=void 0,a.value=!0,clearTimeout(e),e=window.setTimeout(()=>{a.value&&(a.value=!1,o())},400),n.visible=!1,(l=t.closed)==null||l.call(t)}function p(){!a.value||(a.value=!1,o())}const v=F({name:"ElLoading",setup(){return()=>{const l=n.spinner||n.svg,r=m("svg",g({class:"circular",viewBox:n.svgViewBox?n.svgViewBox:"25 25 50 50"},l?{innerHTML:l}:{}),[m("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none"})]),R=n.text?m("p",{class:"el-loading-text"},[n.text]):void 0;return m(I,{name:"el-loading-fade",onAfterLeave:p},{default:$(()=>[V(E("div",{style:{backgroundColor:n.background||""},class:["el-loading-mask",n.customClass,n.fullscreen?"is-fullscreen":""]},[m("div",{class:"el-loading-spinner"},[r,R])]),[[Q,n.visible]])])})}}}),d=v.mount(document.createElement("div"));return b(g({},D(n)),{setText:s,remvoeElLoadingChild:i,close:c,handleAfterLeave:p,vm:d,get $el(){return d.$el}})}let x;const ce=function(t={}){if(!M)return;const e=ue(t);if(e.fullscreen&&x)return x;const a=ie(b(g({},e),{closed:()=>{var s;(s=e.closed)==null||s.call(e),e.fullscreen&&(x=void 0)}}));de(e,e.parent,a),P(e,e.parent,a),e.parent.vLoadingAddClassList=()=>P(e,e.parent,a);let n=e.parent.getAttribute("loading-number");return n?n=`${Number.parseInt(n)+1}`:n="1",e.parent.setAttribute("loading-number",n),e.parent.appendChild(a.$el),N(()=>a.visible.value=e.visible),e.fullscreen&&(x=a),a},ue=t=>{var e,a,n,s;let o;return J(t.target)?o=(e=document.querySelector(t.target))!=null?e:document.body:o=t.target||document.body,{parent:o===document.body||t.body?document.body:o,background:t.background||"",svg:t.svg||"",svgViewBox:t.svgViewBox||"",spinner:t.spinner||!1,text:t.text||"",fullscreen:o===document.body&&((a=t.fullscreen)!=null?a:!0),lock:(n=t.lock)!=null?n:!1,customClass:t.customClass||"",visible:(s=t.visible)!=null?s:!0,target:o}},de=async(t,e,a)=>{const{nextZIndex:n}=Y(),s={};if(t.fullscreen)a.originalPosition.value=f(document.body,"position"),a.originalOverflow.value=f(document.body,"overflow"),s.zIndex=n();else if(t.parent===document.body){a.originalPosition.value=f(document.body,"position"),await N();for(const o of["top","left"]){const i=o==="top"?"scrollTop":"scrollLeft";s[o]=`${t.target.getBoundingClientRect()[o]+document.body[i]+document.documentElement[i]-Number.parseInt(f(document.body,`margin-${o}`),10)}px`}for(const o of["height","width"])s[o]=`${t.target.getBoundingClientRect()[o]}px`}else a.originalPosition.value=f(e,"position");for(const[o,i]of Object.entries(s))a.$el.style[o]=i},P=(t,e,a)=>{a.originalPosition.value!=="absolute"&&a.originalPosition.value!=="fixed"?L(e,"el-loading-parent--relative"):_(e,"el-loading-parent--relative"),t.fullscreen&&t.lock?L(e,"el-loading-parent--hidden"):_(e,"el-loading-parent--hidden")},C=Symbol("ElLoading"),A=(t,e)=>{var a,n,s,o;const i=e.instance,c=l=>j(e.value)?e.value[l]:void 0,p=l=>{const r=J(l)&&(i==null?void 0:i[l])||l;return r&&S(r)},u=l=>p(c(l)||t.getAttribute(`element-loading-${U(l)}`)),v=(a=c("fullscreen"))!=null?a:e.modifiers.fullscreen,d={text:u("text"),svg:u("svg"),svgViewBox:u("svgViewBox"),spinner:u("spinner"),background:u("background"),customClass:u("customClass"),fullscreen:v,target:(n=c("target"))!=null?n:v?void 0:t,body:(s=c("body"))!=null?s:e.modifiers.body,lock:(o=c("lock"))!=null?o:e.modifiers.lock};t[C]={options:d,instance:ce(d)}},ve=(t,e)=>{for(const a of Object.keys(e))W(e[a])&&(e[a].value=t[a])},ge={mounted(t,e){e.value&&A(t,e)},updated(t,e){const a=t[C];e.oldValue!==e.value&&(e.value&&!e.oldValue?A(t,e):e.value&&e.oldValue?j(e.value)&&ve(e.value,a.options):a==null||a.instance.close())},unmounted(t){var e;(e=t[C])==null||e.instance.close()}};const B=X("pages",()=>{let t={};const e=T({loading:!0,pageJson:null});return{thisPage:e,getPageJson:async n=>{e.loading=!0;const s=await Z(n);t[n]=s.data,e.pageJson=t[n],e.loading=!1}}}),fe={class:"amis-page"},ye=ee({setup(t){const{thisPage:e}=te(B()),{getPageJson:a}=B(),n=ae();return ne(()=>n.path,async s=>{await a(s)}),le(async()=>{await a(n.path)}),(s,o)=>{const i=ge;return V((k(),oe("div",fe,[E(I,{name:"slide-up",mode:"out-in"},{default:$(()=>[y(e).pageJson?(k(),se(q,{key:y(n).path,"amis-json":y(e).pageJson},null,8,["amis-json"])):re("",!0)]),_:1})])),[[i,y(e).loading]])}}});export{ye as default};
